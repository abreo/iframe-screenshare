!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):e.iframeScreenshare=i()}(this,function(){"use strict";var e=function(e){if(window.chrome&&window.chrome.webstore){var i=function i(n){if(n&&n.data&&"getScreen"===n.data.type){var r=window.sessionStorage.getScreenMediaJSExtensionId;if(!r)try{return window.chrome.webstore.install(e,function(){setTimeout(function(){return window.sessionStorage.getScreenMediaJSExtensionId=e.split("/").pop(),n.data.installOnly?n.source.postMessage(n.data,"*"):void i(n)},2500)})}catch(e){return n.source.postMessage({err:e},"*")}window.chrome.runtime.sendMessage(r,n.data,function(e){n.source.postMessage(e,"*")})}};window.addEventListener("message",i)}},i=function(e,i){if(!window.navigator||!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia){if(!Promise)throw new Error("requestScreenShare called in unsupported browser");return Promise.reject("Unsupported")}if(window.chrome)return new Promise(function(n,r){window.addEventListener("message",function(i){if(!i||!i.data.sourceId)return i.data.err?r(i.data.err):i.data.installOnly?n(i.data):r(new Error("User Cancellation"));var t=e&&e.chrome||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:15,chromeMediaSourceId:i.data.sourceId}}};window.navigator.mediaDevices.getUserMedia(t).then(n,r)}),window.parent.postMessage({type:"getScreen",installOnly:i,id:1,url:window.location.origin},"*")});if(!i){var n=e&&e.firefox||{audio:!1,video:{mediaSource:"window"}};return window.navigator.mediaDevices.getUserMedia(n)}},n={initializeScreenShare:e,requestScreenShare:i};return n});
