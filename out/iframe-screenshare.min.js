!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.iframeScreenshare=n()}(this,function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(n){if(window.chrome&&window.chrome.webstore){var o=function o(t){if(t&&t.data&&"getScreen"===t.data.type){var r=window.sessionStorage.getScreenMediaJSExtensionId;if(!r)try{var i=function(){var e=n.split("/").pop();return{v:window.chrome.webstore.install(n,function(){setTimeout(function(){return window.sessionStorage.getScreenMediaJSExtensionId=e,t.data.installOnly?t.source.postMessage(t.data,"*"):void o(t)},2500)})}}();if("object"===("undefined"==typeof i?"undefined":e(i)))return i.v}catch(e){return t.source.postMessage({err:e},"*")}window.chrome.runtime.sendMessage(r,t.data,function(e){t.source.postMessage(e,"*")})}};window.addEventListener("message",o)}},o=function(e,n){if(!window.navigator||!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia){if(!Promise)throw new Error("requestScreenShare called in unsupported browser");return Promise.reject("Unsupported")}if(window.chrome)return new Promise(function(o,t){window.addEventListener("message",function(n){if(!n||!n.data.sourceId)return n.data.err?t(n.data.err):n.data.installOnly?o(n.data):t(new Error("User Cancellation"));var r=e&&e.chrome||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:15,chromeMediaSourceId:n.data.sourceId}}};window.navigator.mediaDevices.getUserMedia(r).then(o,t)}),window.parent.postMessage({type:"getScreen",installOnly:n,id:1,url:window.location.origin},"*")});if(!n){var o=e&&e.firefox||{audio:!1,video:{mediaSource:"window"}};return window.navigator.mediaDevices.getUserMedia(o)}},t={initializeScreenShare:n,requestScreenShare:o};return t});
