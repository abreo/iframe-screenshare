!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.iframeScreenshare=n()}(this,function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(n){if(window.chrome&&window.chrome.webstore){var o=function o(r){if(r&&r.data&&"getScreen"===r.data.type){var t=window.sessionStorage.getScreenMediaJSExtensionId;if(!t)try{var i=function(){var e=n.split("/").pop();return{v:window.chrome.webstore.install(n,function(){setTimeout(function(){return window.sessionStorage.getScreenMediaJSExtensionId=e,r.data.installOnly?r.source.postMessage(r.data,"*"):void o(r)},2500)})}}();if("object"===("undefined"==typeof i?"undefined":e(i)))return i.v}catch(e){return r.source.postMessage({err:e},"*")}window.chrome.runtime.sendMessage(t,r.data,function(e){r.source.postMessage(e,"*")})}};window.addEventListener("message",o)}},o=function(e,n){if(!window.navigator||!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia){if(!Promise)throw new Error("requestScreenShare called in unsupported browser");return Promise.reject(new Error("Unsupported"))}if(window.chrome)return new Promise(function(o,r){window.addEventListener("message",function(n){if(!n||!n.data.sourceId)return n.data.err?r(n.data.err):n.data.installOnly?o(n.data):r(new Error("User Cancellation"));var t=e&&e.chrome||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:15,chromeMediaSourceId:n.data.sourceId}}};window.navigator.mediaDevices.getUserMedia(t).then(o,r)}),window.parent.postMessage({type:"getScreen",installOnly:n,id:1,url:window.location.origin},"*")});if(!n){var o=e&&e.firefox||{audio:!1,video:{mediaSource:"window"}};return window.navigator.mediaDevices.getUserMedia(o)}},r={initializeScreenShare:n,requestScreenShare:o};return r});
