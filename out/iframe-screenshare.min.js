!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.iframeScreenshare=n()}(this,function(){"use strict";return{initializeScreenShare:function(e){if(window.chrome&&window.chrome.webstore){var n=function n(r){if(r&&r.data&&"getScreen"===r.data.type){var i=window.sessionStorage.getScreenMediaJSExtensionId;if(!i)try{var t=e.split("/").pop();return window.chrome.webstore.install(e,function(){setTimeout(function(){if(window.sessionStorage.getScreenMediaJSExtensionId=t,r.data.installOnly)return r.source.postMessage(r.data,"*");n(r)},2500)})}catch(e){return r.source.postMessage({err:e},"*")}r.data.installOnly||window.chrome.runtime.sendMessage(i,r.data,function(e){r.source.postMessage(e,"*")})}};window.addEventListener("message",n)}},requestScreenShare:function(e,n){if(!window.navigator||!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia){if(!Promise)throw new Error("requestScreenShare called in unsupported browser");return Promise.reject(new Error("Unsupported"))}if(window.chrome)return new Promise(function(r,i){window.addEventListener("message",function(n){if(!n||!n.data.sourceId)return n.data.err?i(n.data.err):n.data.installOnly?r(n.data):i(new Error("User Cancellation"));var t=e&&e.chrome||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:15,chromeMediaSourceId:n.data.sourceId}}};window.navigator.mediaDevices.getUserMedia(t).then(r,i)}),window.parent.postMessage({type:"getScreen",installOnly:n,id:1,url:window.location.origin},"*")});if(!n){var r=e&&e.firefox||{audio:!1,video:{mediaSource:"window"}};return window.navigator.mediaDevices.getUserMedia(r)}}}});
